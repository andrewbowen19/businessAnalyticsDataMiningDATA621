---
title: "DATA 621 Blog 3"
author: "Andrew Bowen"
date: "2023-11-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In this blog post I'll be looking to create a generalized linear model. I'm basing some work off this [DataCamp GLM Tutorial](https://www.datacamp.com/tutorial/generalized-linear-models) as a reference


We'll be working off the built-in [`cervical` dataset from the GLMsData package in R](https://cran.r-project.org/web/packages/GLMsData/GLMsData.pdf), which tracks the number of deaths from cervical cancer for.
```{r message=FALSE, echo=FALSE}
library(tidyverse)
library(GLMsData)

data(cervical)
```




First let's build a basic linear 
```{r}
lm1 <- lm(Deaths ~ Age + Country + Wyears, cervical)

summary(lm1)
```

Let's create a plot of our linear model to see how well of a fit we're getting.

```{r}
plot(lm1)
```


We can see from the *Residuals vs Fitted* graph that our residuals from a basic linear model have a general pattern. Let's plot a histogram of our residuals in order to see if they are normally distributed, which is an assumption of linearity when modeling.

```{r}
hist(lm1$residuals)
```

```{r}
AIC(lm1)
```


We can now build a generalized linear model using the R function `glm`. Given we're dealing with count data (number of deaths), we can pass the `family=poisson` parameter to model based off the Poisson distribution.

```{r}
glm1 <- glm(Deaths ~ Age + Country + Wyears, family="poisson", data=cervical)
summary(glm1)
```


We can use the [Akaike Information Criterion](https://en.wikipedia.org/wiki/Akaike_information_criterion) as a measure of goodness of fit of our model. In general, a minimized AIC value is preferred, and our GLM is seeing better performance out of our poisson-based GLM (206) than our regular linear model (247)

Let's take a look at our adjusted-$R^2$ values as well. Our linear model produced an $R^2$ value of  0.7652. By contrast, our GLM produced an adjuster $R^2$ of 

```{r}
with(summary(glm1), 1 - deviance/null.deviance)
```

Which is an improvement from the linear model!












